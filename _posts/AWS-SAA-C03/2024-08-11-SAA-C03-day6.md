---
title: "SAA-C03 Day 6 | RDS, Aurora, ElasticCache"
date: 2024-08-11 00:00:00
categories: [AWS, SAA-C03]
tags: [RDS]
---

## RDS
- Automated provisioning, OS patching
- Continuous backup and restore to specific timestamp
- Read Replicas
- Multi AZ
- Scaling Capability (Horizontal or Vertical) - Compute power
- Storage Auto Scaling
  - Have to set Maximum Storage Threshold ( avoid unlimited scale)
  - (non customizable) : Available Storage Drops Below 10% **AND**
  - (non customizable) :Low Storage Condition Persists for 5 Minutes **AND**
  - (non customizable) : It Has Been at Least 6 Hours Since the Last Storage Scaling Operation
- Storage Backed By EBS


### RDS Read Replica vs Multi AZ

#### Read Replica
- Up to 15 Read Replica (either within AZ, cross AZ, or Cross Region)
- Async , reads are eventually consistent
- Replica can become actual DB
- each Replica has its own endpoint

#### Read Replica: Use case
- Run some report or analytics, but dont want to affect production application


#### Multi AZ (Disaster Recovery)
- SYNC Replication
- one DNS name: automatic failover
- No manual intervention
- Read Replica can be set as Multi AZ for DR
- **Zero down time** from Single AZ to Multi AZ
  - a snapshot taken
  - new DB restore from snapshot in a New AZ
  - Sync established


### RDS Custom
- Only for **Managed Oracle* & **Microsoft SQL Server DB** with OS and db customization
- Custom part:
  - access to the underlying db and OS
  - configure setting
  - install patches
  - enable native feature
  - ssh to instance
- need to deactivate the automation mode


## Amazon Aurora
- Support MySQL and Postgres
- High Performance (5x more than MySQL RDS, 3x more than Postgres RDS), 
- Auto High Availability and Auto Read Scaling (if choose high availability)
- also can have 15 read replica (but process is faster)
- Replica and primary shared resource in the same AZ

### High Availability & Read Scaling
- 6 copies of data across 3 AZ (2 copies of each AZ)
- **One Write Instance:** Only one instance (the primary instance) in the Aurora cluster is responsible for writing data.
- **Automatic Failover:** If the primary instance fails, Aurora automatically promotes one of the read replicas to be the new primary instance, taking over write operations without manual intervention.
- **Auto Scaling:** can define auto scaling policy when read replica experience high CPU (horizontal scale)
- **Custom Endpoint:** can define a subset of AUrora instance as Custom Endpoint (they might have strong power) can run some analytic query

### good to know
- The 6 copies of data across three AZs are not accessed directly by your application. They exist to support failover, synchronization, and data durability.
- Your application primarily interacts with the primary instance via its endpoint for both reads and writes, and optionally with read replicas if you've created them for read scalability.

### Aurora Serverless
- Use RDS Proxy for Connection Management:
  - High-Concurrency Applications: If your application has high connection churn, such as serverless architectures (e.g., AWS Lambda) or microservices, using RDS Proxy can help manage connections efficiently. It pools and reuses connections, reducing the overhead of opening and closing database connections.
  - Connection Pooling: Leverage RDS Proxy's connection pooling to optimize the number of database connections, preventing the Aurora instance from being overwhelmed by too many simultaneous connections.


### Global Aurora Database
- 1 Primary Region, up to 5 secondary(read only) regions
- up to 16 read replicas each secondary region
- can promoting secondary region takes RTO < 1 minute


### RDS & Aurora Backup

#### Automated backup for RDS
- RDS automatically performs a full daily snapshot of your database during a specified backup window
- In addition to these daily snapshots, RDS also captures transaction logs throughout the day every 5 minutes, which allows for point-in-time recovery 
- retention period from 1 to 35 days. RDS will retain all backups and transaction logs during this period ( can be disabled)

#### Automated back up for Aurora
- 1 - 35 days (can not be disabled)
- Aurora allows you to restore your database to any specific second within the retention period. This is particularly useful if you need to recover from accidental data changes or deletions.

#### Manual DB snapshots for Both
- retention of backup for as long as you want
- stop RDS still pay for storage, if plan for long time, should take snapshot and restore instead

#### Restore Options
- snapshot restore
- restoring RDS from S3 ( backup for db and store it in S3 and restore it): typically used for on prem
- restore Aurora from S3  ( back up using XtraBackup and store in S3 the restore)

#### Aurora Database Cloning
- create a new Aurora DB Cluster from existing one
- Faster than snapshot & restore
- used for staging db

### RDS Proxy
1. Connection Pooling
   - **Pooling Database Connections:** RDS Proxy creates and manages a pool of database connections that can be shared across multiple applications or instances. Instead of each application or Lambda function creating its own database connection, they connect to the proxy, which then manages and reuses a smaller number of actual database connections.
   - **Benefits:** This reduces the overhead associated with establishing and tearing down connections, especially in environments with many short-lived connections
2. Improved Security:
   - **IAM Authentication:** RDS Proxy supports IAM-based authentication, which allows you to manage database access securely using AWS Identity and Access Management (IAM) without needing to store database credentials in your application.
   - **Integration with AWS Secrets Manager:** RDS Proxy can automatically rotate and securely store database credentials in AWS Secrets Manager. The proxy retrieves and uses these credentials to connect to the database, further enhancing security.
3. Use case Lambda:
   - Lambda Integration: RDS Proxy is particularly useful in serverless architectures, such as those using AWS Lambda. Lambda functions often need to open and close database connections quickly, which can overwhelm a database. RDS Proxy maintains a warm pool of connections, reducing the latency typically associated with opening new connections in Lambda.
4. never public access
5. RDS Proxy is associated with a single database instance or a cluster (in the case of Aurora, where you might have multiple read replicas). The proxy manages connections to this specific database or cluster, and it does not route connections to different databases.
6. Amazon RDS Proxy can differentiate between read and write operations



## ElastiCache 
- In-Memory Data Store: Managed Redis or Memcached
- Use case: Web Session Storage, Database Caching, Real-Time Analytics

### Redis vs Memcache

#### Redis
- Multi AZ with Failover
- High Availability
- Backup and restore
- support sets, sorted sets
- suports IAM

#### Memcached
- have sharding
- no high availability
- no backup and restore
- multi threaded architecture
